<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Log In | Sign Up</title>
    <link href="images/favicon.png" type="image/png" rel="icon">
    <link href="css/style-index.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">
</head>
    <body>
        <div class="diagonal">
            <div id="Title" class="title">
                <h1>SLP 17<br>Contact Manager</h1>
            </div>
        </div>
        <h1><br></h1>
        <div id="Tab Button" class="tab">
            <button class="tab-button" onclick="displayLogin()" id="tab">Existing Users</button>
            <script>
                document.getElementById("tab").click();
            </script>
            <button class="tab-button" onclick="displaySignup()">New Users</button>
        </div>
        <div id="Log In" class="tab-login">
            <div class="wrapper">
                <h1>Welcome back.</h1>
                <div class="input">
                    <input id="loginEmail" type="email" placeholder="Email" name="email" required>
                </div>
                <div class="input">
                    <input id="loginPassword" type="password" placeholder="Password" name="pw" required>
                </div>
                <button type="submit" class="submit-button" onclick="validateLogin()">Log In</button>
                <div class="message"><br></div>
                <div id="Login Message" class="message"></div>
            </div>
        </div>
        <div id="Sign Up" class="tab-signup">
            <form id="registrationForm">
                <div class="wrapper">
                    <h1>Create an account.</h1>
                    <div class="input">
                        <input id="signupEmail" type="email" placeholder="Email" name="email" required>
                    </div>
                    <div class="input">
                        <input id="signupPassword" type="password" placeholder="Password" name="pw1" required>
                    </div>
                    <div class="input">
                        <input id="signupPasswordConfirm" type="password" placeholder="Confirm Password" name="pw2" required>
                    </div>
                    <button type="submit" class="submit-button">Sign Up</button>
                    <div class="mt">
                        <p class="error" id="message"></p>
                    </div>
                    
                    <div class="message"><br></div>
                    <div id="Email Message" class="message"></div>
                    <div id="Password Message" class="message"></div>
                </div>
            </form>
        </div>
        <script>
            function displayLogin() {
                var i, loginTab, signupTab;

                signupTab = document.getElementsByClassName("tab-signup");
                for (i = 0; i < signupTab.length; i++) {
                    signupTab[i].style.display = "none";
                }

                loginTab = document.getElementsByClassName("tab-login");
                for (i = 0; i < loginTab.length; i++) {
                    loginTab[i].style.display = "flex";
                }
            }

            function displaySignup() {
                var i, loginTab, signupTab;

                loginTab = document.getElementsByClassName("tab-login");
                for (i = 0; i < loginTab.length; i++) {
                    loginTab[i].style.display = "none";
                }

                signupTab = document.getElementsByClassName("tab-signup");
                for (i = 0; i < signupTab.length; i++) {
                    signupTab[i].style.display = "flex";
                }
            }

            function validateLogin() {
                var email = document.getElementById("loginEmail").value;
                var password = document.getElementById("loginPassword").value;

                // Replace the current admin access with a search against the database
                if(email === "user@admin.com" && password === "admin") {
                    console.log("Login Success!");
                    window.location.href = "home.html";  // Redirects to home.html
                } else {
                    document.getElementById("Login Message").innerHTML = "Incorrect email or password.";
                    console.log("Wrong credentials: \nemail: user@admin.com,\n password: admin");
                }
            }

            function validateSignup() {
                var email = document.getElementById("signupEmail").value;
                var pw1 = document.getElementById("signupPassword").value;
                var pw2 = document.getElementById("signupPasswordConfirm").value;

                // Replace the current admin access with a search against the database
                if (email == "user@admin.com")
                {
                    document.getElementById("Email Message").innerHTML = "An account already exists for this email.";
                    document.getElementById("Password Message").innerHTML = "";
                }

                if (pw1 != pw2) {
                    document.getElementById("Password Message").innerHTML = "Passwords do not match.";
                    document.getElementById("Email Message").innerHTML = "";
                }

                else if (email != "user@admin.com" && pw1 == pw2) {
                    // Still needs to add new account to database
                    window.location.href = "home.html";
                }
            }


            document.addEventListener("DOMContentLoaded", function () {
                const registrationForm = document.getElementById("registrationForm");
                const messageElement = document.getElementById("message");

                registrationForm.addEventListener("submit", function (e) {
                    e.preventDefault(); // Prevent the form from submitting

                    // Get the values entered by the user
                    const email = registrationForm.email.value;
                    /*const password = registrationForm.password.value;*/

                    // Load and parse the JSON data from users.json (you can use Fetch API here)
                    const users = [
                        { "email": "user1@example.com" },
                        { "email": "user2@example.com" },
                        { "email": "user@admin.com" },
                        { "email": "david@bandit.com" },
                        { "email": "burt@bandit.com" },
                        { "email": "sam@bandit.com" }
                    ];

                    // Check if the entered email already exists
                    const userExists = users.some(user => user.email === email);

                    if (userExists) {
                        messageElement.textContent = "This email is already registered.";
                    } else {
                        // Add the new user to the list (you can also save it to your JSON file here)
                        users.push({ email, password });
                        messageElement.textContent = "User registered successfully!";
                        registrationForm.reset(); // Clear the form
                    }
                });
            });
           
        </script>
    </body>
</html>
